\doxysection{user\+\_\+tcfs.\+c}
\hypertarget{user__tcfs_8c_source}{}\label{user__tcfs_8c_source}\index{user/old\_stuff/user\_tcfs.c@{user/old\_stuff/user\_tcfs.c}}
\mbox{\hyperlink{user__tcfs_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{tcfs__helper__tools_8h}{tcfs\_helper\_tools.h}}"{}}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00002}00002\ \textcolor{preprocessor}{\#include\ <argp.h>}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00003}00003\ \textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00004}00004\ \textcolor{preprocessor}{\#include\ <stdlib.h>}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00016}\mbox{\hyperlink{user__tcfs_8c_a2026b95fe28c77f392e54ca5b26a0899}{00016}}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{user__tcfs_8c_a2026b95fe28c77f392e54ca5b26a0899}{argp\_program\_version}}\ =\ \textcolor{stringliteral}{"{}TCFS\ user\ helper\ program"{}};}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00022}\mbox{\hyperlink{user__tcfs_8c_a794b57947d8e4dc6456b6a8a31de2579}{00022}}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{user__tcfs_8c_a794b57947d8e4dc6456b6a8a31de2579}{argp\_program\_bug\_address}}\ =\ \textcolor{stringliteral}{"{}carloalbertogiordano@duck.com"{}};}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00028}\mbox{\hyperlink{user__tcfs_8c_a3a72da5720995770156f9f9879ce6fa9}{00028}}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{user__tcfs_8c_a3a72da5720995770156f9f9879ce6fa9}{doc}}[]\ =\ \textcolor{stringliteral}{"{}TCFS\ user\ accepts\ one\ of\ three\ arguments:\ mount,\ "{}}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}create-\/shared,\ or\ umount."{}};}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00036}\mbox{\hyperlink{user__tcfs_8c_ac88b371bbf7f89ab6440cb9fe629288c}{00036}}\ \textcolor{keyword}{static}\ \textcolor{keyword}{struct\ }argp\_option\ \mbox{\hyperlink{user__tcfs_8c_ac88b371bbf7f89ab6440cb9fe629288c}{options}}[]}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00037}00037\ \ \ \ \ =\ \{\ \{\ \textcolor{stringliteral}{"{}mount"{}},\ \textcolor{charliteral}{'m'},\ 0,\ 0,\ \textcolor{stringliteral}{"{}Perform\ mount\ operation"{}},\ -\/1\ \},}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00038}00038\ \ \ \ \ \ \ \ \ \{\ \textcolor{stringliteral}{"{}create-\/shared"{}},\ \textcolor{charliteral}{'c'},\ 0,\ 0,\ \textcolor{stringliteral}{"{}Perform\ create-\/shared\ operation"{}},\ -\/1\ \},}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00039}00039\ \ \ \ \ \ \ \ \ \{\ \textcolor{stringliteral}{"{}umount"{}},\ \textcolor{charliteral}{'u'},\ 0,\ 0,\ \textcolor{stringliteral}{"{}Perform\ umount\ operation"{}},\ -\/1\ \},}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00040}00040\ \ \ \ \ \ \ \ \ \{\ \textcolor{stringliteral}{"{}setup-\/env"{}},\ \textcolor{charliteral}{'s'},\ 0,\ 0,\ \textcolor{stringliteral}{"{}Perform\ the\ setup\ of\ the\ .tcfs\ folder"{}},}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ -\/1\ \},}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00042}00042\ \ \ \ \ \ \ \ \ \{\ NULL\ \}\ \};}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00048}\mbox{\hyperlink{structarguments}{00048}}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structarguments}{arguments}}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00049}00049\ \{}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00050}\mbox{\hyperlink{structarguments_a0dbf3970b8b18964140f0397c22a3711}{00050}}\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structarguments_a0dbf3970b8b18964140f0397c22a3711}{operation}};\ }
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00052}00052\ \};}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00053}00053\ }
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00063}00063\ \textcolor{keyword}{static}\ error\_t}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00064}\mbox{\hyperlink{user__tcfs_8c_a35ee63236273ebb9325c444cacf00159}{00064}}\ \mbox{\hyperlink{user__tcfs_8c_a35ee63236273ebb9325c444cacf00159}{parse\_opt}}\ (\textcolor{keywordtype}{int}\ key,\ \textcolor{keywordtype}{char}\ *arg,\ \textcolor{keyword}{struct}\ argp\_state\ *state)}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00065}00065\ \{}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00066}00066\ \ \ (void)arg;}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00068}00068\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structarguments}{arguments}}\ *\mbox{\hyperlink{structarguments}{arguments}}\ =\ state-\/>input;}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00069}00069\ \ \ \textcolor{keywordflow}{switch}\ (key)}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00070}00070\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00071}00071\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'m'}:}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00072}00072\ \ \ \ \ \ \ \mbox{\hyperlink{structarguments}{arguments}}-\/>\mbox{\hyperlink{structarguments_a0dbf3970b8b18964140f0397c22a3711}{operation}}\ =\ 1;\ \textcolor{comment}{//\ Mount}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00073}00073\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00074}00074\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'c'}:}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00075}00075\ \ \ \ \ \ \ \mbox{\hyperlink{structarguments}{arguments}}-\/>\mbox{\hyperlink{structarguments_a0dbf3970b8b18964140f0397c22a3711}{operation}}\ =\ 2;\ \textcolor{comment}{//\ Create-\/shared}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00076}00076\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00077}00077\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'u'}:}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00078}00078\ \ \ \ \ \ \ \mbox{\hyperlink{structarguments}{arguments}}-\/>\mbox{\hyperlink{structarguments_a0dbf3970b8b18964140f0397c22a3711}{operation}}\ =\ 3;\ \textcolor{comment}{//\ Umount}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00079}00079\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00080}00080\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'s'}:}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00081}00081\ \ \ \ \ \ \ \mbox{\hyperlink{structarguments}{arguments}}-\/>\mbox{\hyperlink{structarguments_a0dbf3970b8b18964140f0397c22a3711}{operation}}\ =\ 4;\ \textcolor{comment}{//\ Set\ up\ the\ env}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00082}00082\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00083}00083\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00084}00084\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ARGP\_ERR\_UNKNOWN;}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00085}00085\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00086}00086\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00087}00087\ \}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00093}\mbox{\hyperlink{user__tcfs_8c_ab70c96531b1b652d70c221cfaf3207f3}{00093}}\ \textcolor{keyword}{static}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structargp}{argp}}\ \mbox{\hyperlink{structargp}{argp}}\ =\ \{\ .options\ =\ \mbox{\hyperlink{user__tcfs_8c_ac88b371bbf7f89ab6440cb9fe629288c}{options}},}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .parser\ =\ \mbox{\hyperlink{user__tcfs_8c_a35ee63236273ebb9325c444cacf00159}{parse\_opt}},}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .doc\ =\ \mbox{\hyperlink{user__tcfs_8c_a3a72da5720995770156f9f9879ce6fa9}{doc}},}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .args\_doc\ =\ NULL,}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .children\ =\ NULL,}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .help\_filter\ =\ NULL\ \};}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00099}00099\ }
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00103}00103\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00104}\mbox{\hyperlink{user__tcfs_8c_a0ddf1224851353fc92bfbff6f499fa97}{00104}}\ \mbox{\hyperlink{namespacemain}{main}}\ (\textcolor{keywordtype}{int}\ argc,\ \textcolor{keywordtype}{char}\ *argv[])}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00105}00105\ \{}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00106}00106\ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structarguments}{arguments}}\ \mbox{\hyperlink{structarguments}{arguments}};}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00107}00107\ \ \ \mbox{\hyperlink{structarguments}{arguments}}.\mbox{\hyperlink{structarguments_a0dbf3970b8b18964140f0397c22a3711}{operation}}\ =\ 0;\ \textcolor{comment}{//\ Default\ value}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00108}00108\ \ \ \textcolor{keywordtype}{int}\ result\ =\ 0;}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00109}00109\ }
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00110}00110\ \ \ \textcolor{comment}{//\ Parse\ the\ arguments}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00111}00111\ \ \ argp\_parse\ (\&\mbox{\hyperlink{structargp}{argp}},\ argc,\ argv,\ 0,\ 0,\ \&\mbox{\hyperlink{structarguments}{arguments}});}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00112}00112\ }
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00113}00113\ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{structarguments}{arguments}}.\mbox{\hyperlink{structarguments_a0dbf3970b8b18964140f0397c22a3711}{operation}})}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00114}00114\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00115}00115\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00116}00116\ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}Mounting\ your\ FS,\ Please\ specify\ the\ location\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00117}00117\ \ \ \ \ \ \ result\ =\ \mbox{\hyperlink{tcfs__helper__tools_8c_a769edcf066efb97f5ae3a81e3507a793}{do\_mount}}\ ();}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00118}00118\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00119}00119\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ fprintf\ (stderr,\ \textcolor{stringliteral}{"{}An\ error\ occurred\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00121}00121\ \ \ \ \ \ \ \ \ \ \ exit\ (-\/1);}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00122}00122\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00123}00123\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00124}00124\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00125}00125\ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}You\ chose\ the\ 'create-\/shared'\ operation.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00126}00126\ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ specific\ logic\ for\ 'create-\/shared'\ here.}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00127}00127\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00128}00128\ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00129}00129\ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}You\ chose\ the\ 'umount'\ operation.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00130}00130\ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ specific\ logic\ for\ 'umount'\ here.}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00131}00131\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00132}00132\ \ \ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00133}00133\ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}You\ chose\ the\ 'setup\ environment'\ option\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00134}00134\ \ \ \ \ \ \ result\ =\ \mbox{\hyperlink{tcfs__helper__tools_8c_abe60a9bd3f55341eb2496670553f9d26}{setup\_tcfs\_env}}\ ();}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00135}00135\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00136}00136\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00137}00137\ \ \ \ \ \ \ \ \ \ \ fprintf\ (stderr,\ \textcolor{stringliteral}{"{}An\ error\ occurred\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00138}00138\ \ \ \ \ \ \ \ \ \ \ exit\ (-\/1);}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00139}00139\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00140}00140\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00141}00141\ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}Invalid\ argument.\ Choose\ from\ 'mount',\ 'create-\/shared',\ or\ "{}}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00142}00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}'umount'.\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00143}00143\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00144}00144\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00145}00145\ }
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00146}00146\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{user__tcfs_8c_source_l00147}00147\ \}}

\end{DoxyCode}
