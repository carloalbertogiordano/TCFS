\doxysection{userspace-\/module/utils/crypt-\/utils/crypt-\/utils.c File Reference}
\hypertarget{crypt-utils_8c}{}\label{crypt-utils_8c}\index{userspace-\/module/utils/crypt-\/utils/crypt-\/utils.c@{userspace-\/module/utils/crypt-\/utils/crypt-\/utils.c}}


Implementation file for cryptographic utility functions.  


{\ttfamily \#include "{}crypt-\/utils.\+h"{}}\newline
Include dependency graph for crypt-\/utils.c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{crypt-utils_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{crypt-utils_8c_afcf795f5a96fd55561abe69f56224630}{BLOCKSIZE}}~1024
\begin{DoxyCompactList}\small\item\em This defines the max size of a block that can be cyphered. This definition is marked as internal and should not be used directly by the user. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{crypt-utils_8c_ad7bb30dbf5882fdf05331918e8a0cc84}{IV\+\_\+\+SIZE}}~32
\begin{DoxyCompactList}\small\item\em The fixed size of the initialization vector \doxylink{}{IV }. This definition is marked as internal and should not be used directly by the user. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{crypt-utils_8c_a2d996237e082b78b41771b5aa1a6eae1}{KEY\+\_\+\+SIZE}}~32
\begin{DoxyCompactList}\small\item\em The fixed size of the key. This definition is marked as internal and should not be used directly by the user. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{crypt-utils_8c_a94b5b388b3f00982ccee72b192077e76}{do\+\_\+crypt}} (FILE \texorpdfstring{$\ast$}{*}in, FILE \texorpdfstring{$\ast$}{*}out, int action, unsigned char \texorpdfstring{$\ast$}{*}key\+\_\+str)
\begin{DoxyCompactList}\small\item\em High level function interface for performing AES encryption on FILE pointers Uses Open\+SSL libcrypto EVP API ~\newline
. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{crypt-utils_8c_aa377df016f593aa771013264acc9b86b}{check\+\_\+entropy}} (void)
\begin{DoxyCompactList}\small\item\em Verify if there is enough entropy in the system to generate a key. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{crypt-utils_8c_a53b5762e00daafcc3644c03e2fd9b2c4}{add\+\_\+entropy}} (void)
\begin{DoxyCompactList}\small\item\em Force new entropy in /dev/urandom. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{crypt-utils_8c_a8845f5705eaafda836aac91d5881876f}{generate\+\_\+key}} (unsigned char \texorpdfstring{$\ast$}{*}destination)
\begin{DoxyCompactList}\small\item\em Generate a new AES 256 key for a file. \end{DoxyCompactList}\item 
unsigned char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{crypt-utils_8c_aa926098a8843cf0ab6bd7eb8b3bbd2e6}{encrypt\+\_\+string}} (unsigned char \texorpdfstring{$\ast$}{*}plaintext, const char \texorpdfstring{$\ast$}{*}key, int \texorpdfstring{$\ast$}{*}encrypted\+\_\+key\+\_\+len)
\begin{DoxyCompactList}\small\item\em Encrypt the \texorpdfstring{$\ast$}{*}plaintext string using a AES 256 key. \end{DoxyCompactList}\item 
unsigned char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{crypt-utils_8c_a22f528907ee4f078e333501b747d5435}{decrypt\+\_\+string}} (unsigned char \texorpdfstring{$\ast$}{*}ciphertext, const char \texorpdfstring{$\ast$}{*}key)
\begin{DoxyCompactList}\small\item\em Decrypt the \texorpdfstring{$\ast$}{*}ciphertext string using a AES 256 key. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{crypt-utils_8c_a36c2342a7c47b8f41bf628bf473b1c97}{is\+\_\+valid\+\_\+key}} (const unsigned char \texorpdfstring{$\ast$}{*}key)
\begin{DoxyCompactList}\small\item\em Check if a given key is valid. \end{DoxyCompactList}\item 
const char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{crypt-utils_8c_aa4a7facde8c6f63a7225c07e92232b2e}{encrypt\+\_\+file\+\_\+name\+\_\+with\+\_\+hex}} (const char \texorpdfstring{$\ast$}{*}file, const char \texorpdfstring{$\ast$}{*}key)
\item 
const char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{crypt-utils_8c_a3b003481e5c188ac1d6f63e09e6f3a34}{decrypt\+\_\+file\+\_\+name\+\_\+with\+\_\+hex}} (const char \texorpdfstring{$\ast$}{*}enc\+\_\+file, const char \texorpdfstring{$\ast$}{*}key)
\item 
const char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{crypt-utils_8c_ad9b10366ade9f2129ec2613fdc76df80}{encrypt\+\_\+path}} (const char \texorpdfstring{$\ast$}{*}path, const char \texorpdfstring{$\ast$}{*}key)
\begin{DoxyCompactList}\small\item\em Encrypts each part of the given path using a specified key. \end{DoxyCompactList}\item 
const char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{crypt-utils_8c_a5c45db4d3db3ef274fb6356e1a95e644}{encrypt\+\_\+path\+\_\+and\+\_\+filename}} (const char \texorpdfstring{$\ast$}{*}path, const char \texorpdfstring{$\ast$}{*}key)
\begin{DoxyCompactList}\small\item\em Encrypts the given filename with its path using a specified key. \end{DoxyCompactList}\item 
const char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{crypt-utils_8c_a1899c23a523d11ed1cb5601eabdb023d}{decrypt\+\_\+path}} (const char \texorpdfstring{$\ast$}{*}encrypted\+\_\+path, const char \texorpdfstring{$\ast$}{*}key)
\begin{DoxyCompactList}\small\item\em Decrypts each part of the given encrypted path using a specified key. \end{DoxyCompactList}\item 
const char \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{crypt-utils_8c_a373f8aedbcd8b6ce22fe7bdfeb2961c2}{decrypt\+\_\+path\+\_\+and\+\_\+filename}} (const char \texorpdfstring{$\ast$}{*}encrypted\+\_\+path, const char \texorpdfstring{$\ast$}{*}key)
\begin{DoxyCompactList}\small\item\em Decrypts the given encrypted filename with its path using a specified key. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementation file for cryptographic utility functions. 

This file contains the implementation of various cryptographic utility functions, including AES encryption and decryption, key generation, entropy checks, and path encryption/decryption.

\begin{DoxyAuthor}{Author}
By Carlo Alberto Giordnano ~\newline
Created 18/10/23 by \mbox{[}Carlo Alberto Giordano\mbox{]} ~\newline

\end{DoxyAuthor}


Definition in file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.



\doxysubsection{Macro Definition Documentation}
\Hypertarget{crypt-utils_8c_afcf795f5a96fd55561abe69f56224630}\label{crypt-utils_8c_afcf795f5a96fd55561abe69f56224630} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!BLOCKSIZE@{BLOCKSIZE}}
\index{BLOCKSIZE@{BLOCKSIZE}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{BLOCKSIZE}{BLOCKSIZE}}
{\footnotesize\ttfamily \#define BLOCKSIZE~1024}



This defines the max size of a block that can be cyphered. This definition is marked as internal and should not be used directly by the user. 



Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00021}{21}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.

\Hypertarget{crypt-utils_8c_ad7bb30dbf5882fdf05331918e8a0cc84}\label{crypt-utils_8c_ad7bb30dbf5882fdf05331918e8a0cc84} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!IV\_SIZE@{IV\_SIZE}}
\index{IV\_SIZE@{IV\_SIZE}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{IV\_SIZE}{IV\_SIZE}}
{\footnotesize\ttfamily \#define IV\+\_\+\+SIZE~32}



The fixed size of the initialization vector \doxylink{}{IV }. This definition is marked as internal and should not be used directly by the user. 



Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00028}{28}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.

\Hypertarget{crypt-utils_8c_a2d996237e082b78b41771b5aa1a6eae1}\label{crypt-utils_8c_a2d996237e082b78b41771b5aa1a6eae1} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!KEY\_SIZE@{KEY\_SIZE}}
\index{KEY\_SIZE@{KEY\_SIZE}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{KEY\_SIZE}{KEY\_SIZE}}
{\footnotesize\ttfamily \#define KEY\+\_\+\+SIZE~32}



The fixed size of the key. This definition is marked as internal and should not be used directly by the user. 



Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00034}{34}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.



\doxysubsection{Function Documentation}
\Hypertarget{crypt-utils_8c_a53b5762e00daafcc3644c03e2fd9b2c4}\label{crypt-utils_8c_a53b5762e00daafcc3644c03e2fd9b2c4} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!add\_entropy@{add\_entropy}}
\index{add\_entropy@{add\_entropy}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{add\_entropy()}{add\_entropy()}}
{\footnotesize\ttfamily void add\+\_\+entropy (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Force new entropy in /dev/urandom. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
Very dangerous, if this fails an error will be printed and the program will exit with EXIT\+\_\+\+FAILURE 
\end{DoxyNote}


Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00202}{202}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.



Referenced by \mbox{\hyperlink{crypt-utils_8c_source_l00235}{generate\+\_\+key()}}.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{crypt-utils_8c_a53b5762e00daafcc3644c03e2fd9b2c4_icgraph}
\end{center}
\end{figure}
\Hypertarget{crypt-utils_8c_aa377df016f593aa771013264acc9b86b}\label{crypt-utils_8c_aa377df016f593aa771013264acc9b86b} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!check\_entropy@{check\_entropy}}
\index{check\_entropy@{check\_entropy}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{check\_entropy()}{check\_entropy()}}
{\footnotesize\ttfamily int check\+\_\+entropy (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Verify if there is enough entropy in the system to generate a key. 

\begin{DoxyReturn}{Returns}
A value greater than 0 corresponding to the entropy level, if an error occurs false is returned 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
This function evaluates the entropy by checking the /proc/sys/kernel/random/entropy\+\_\+avail file. 
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
man page 4 for random 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00174}{174}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.



Referenced by \mbox{\hyperlink{crypt-utils_8c_source_l00235}{generate\+\_\+key()}}.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{crypt-utils_8c_aa377df016f593aa771013264acc9b86b_icgraph}
\end{center}
\end{figure}
\Hypertarget{crypt-utils_8c_a3b003481e5c188ac1d6f63e09e6f3a34}\label{crypt-utils_8c_a3b003481e5c188ac1d6f63e09e6f3a34} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!decrypt\_file\_name\_with\_hex@{decrypt\_file\_name\_with\_hex}}
\index{decrypt\_file\_name\_with\_hex@{decrypt\_file\_name\_with\_hex}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{decrypt\_file\_name\_with\_hex()}{decrypt\_file\_name\_with\_hex()}}
{\footnotesize\ttfamily const char \texorpdfstring{$\ast$}{*} decrypt\+\_\+file\+\_\+name\+\_\+with\+\_\+hex (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{enc\+\_\+file,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{key }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00406}{406}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.



References \mbox{\hyperlink{crypt-utils_8c_source_l00330}{decrypt\+\_\+string()}}, and \mbox{\hyperlink{tcfs__utils_8c_source_l00218}{hex\+\_\+to\+\_\+string()}}.



Referenced by \mbox{\hyperlink{crypt-utils_8c_source_l00645}{decrypt\+\_\+path()}}, \mbox{\hyperlink{crypt-utils_8c_source_l00759}{decrypt\+\_\+path\+\_\+and\+\_\+filename()}}, and \mbox{\hyperlink{tcfs_8c_source_l00196}{tcfs\+\_\+readdir()}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{crypt-utils_8c_a3b003481e5c188ac1d6f63e09e6f3a34_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{crypt-utils_8c_a3b003481e5c188ac1d6f63e09e6f3a34_icgraph}
\end{center}
\end{figure}
\Hypertarget{crypt-utils_8c_a1899c23a523d11ed1cb5601eabdb023d}\label{crypt-utils_8c_a1899c23a523d11ed1cb5601eabdb023d} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!decrypt\_path@{decrypt\_path}}
\index{decrypt\_path@{decrypt\_path}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{decrypt\_path()}{decrypt\_path()}}
{\footnotesize\ttfamily const char \texorpdfstring{$\ast$}{*} decrypt\+\_\+path (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{encrypted\+\_\+path,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{key }\end{DoxyParamCaption})}



Decrypts each part of the given encrypted path using a specified key. 


\begin{DoxyParams}{Parameters}
{\em encrypted\+\_\+path} & The input encrypted path to be decrypted. \\
\hline
{\em key} & The decryption key. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A dynamically allocated string containing the decrypted path. It is the responsibility of the caller to free this memory. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00645}{645}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.



References \mbox{\hyperlink{crypt-utils_8c_source_l00406}{decrypt\+\_\+file\+\_\+name\+\_\+with\+\_\+hex()}}, and \mbox{\hyperlink{tcfs__utils_8c_source_l00262}{log\+Message()}}.



Referenced by \mbox{\hyperlink{tcfs_8c_source_l00196}{tcfs\+\_\+readdir()}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{crypt-utils_8c_a1899c23a523d11ed1cb5601eabdb023d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=255pt]{crypt-utils_8c_a1899c23a523d11ed1cb5601eabdb023d_icgraph}
\end{center}
\end{figure}
\Hypertarget{crypt-utils_8c_a373f8aedbcd8b6ce22fe7bdfeb2961c2}\label{crypt-utils_8c_a373f8aedbcd8b6ce22fe7bdfeb2961c2} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!decrypt\_path\_and\_filename@{decrypt\_path\_and\_filename}}
\index{decrypt\_path\_and\_filename@{decrypt\_path\_and\_filename}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{decrypt\_path\_and\_filename()}{decrypt\_path\_and\_filename()}}
{\footnotesize\ttfamily const char \texorpdfstring{$\ast$}{*} decrypt\+\_\+path\+\_\+and\+\_\+filename (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{encrypted\+\_\+path,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{key }\end{DoxyParamCaption})}



Decrypts the given encrypted filename with its path using a specified key. 


\begin{DoxyParams}{Parameters}
{\em encrypted\+\_\+path} & The input encrypted path to be decrypted. \\
\hline
{\em key} & The decryption key. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A dynamically allocated string containing the decrypted path with the decrypted filename. It is the responsibility of the caller to free this memory. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00759}{759}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.



References \mbox{\hyperlink{crypt-utils_8c_source_l00406}{decrypt\+\_\+file\+\_\+name\+\_\+with\+\_\+hex()}}, and \mbox{\hyperlink{tcfs__utils_8c_source_l00262}{log\+Message()}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{crypt-utils_8c_a373f8aedbcd8b6ce22fe7bdfeb2961c2_cgraph}
\end{center}
\end{figure}
\Hypertarget{crypt-utils_8c_a22f528907ee4f078e333501b747d5435}\label{crypt-utils_8c_a22f528907ee4f078e333501b747d5435} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!decrypt\_string@{decrypt\_string}}
\index{decrypt\_string@{decrypt\_string}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{decrypt\_string()}{decrypt\_string()}}
{\footnotesize\ttfamily unsigned char \texorpdfstring{$\ast$}{*} decrypt\+\_\+string (\begin{DoxyParamCaption}\item[{unsigned char \texorpdfstring{$\ast$}{*}}]{ciphertext,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{key }\end{DoxyParamCaption})}



Decrypt the \texorpdfstring{$\ast$}{*}ciphertext string using a AES 256 key. 


\begin{DoxyParams}{Parameters}
{\em ciphertext} & This is the string to decrypt in HEX format \\
\hline
{\em key} & The AES 256 KEY \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
unsigned char \texorpdfstring{$\ast$}{*} The plaintext string will be allocated and then returned 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
After the use remember to free the result 
\end{DoxyNote}


Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00330}{330}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.



References \mbox{\hyperlink{tcfs__utils_8c_source_l00262}{log\+Message()}}.



Referenced by \mbox{\hyperlink{crypt-utils_8c_source_l00406}{decrypt\+\_\+file\+\_\+name\+\_\+with\+\_\+hex()}}, \mbox{\hyperlink{tcfs_8c_source_l00734}{tcfs\+\_\+read()}}, and \mbox{\hyperlink{tcfs_8c_source_l00830}{tcfs\+\_\+write()}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=262pt]{crypt-utils_8c_a22f528907ee4f078e333501b747d5435_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{crypt-utils_8c_a22f528907ee4f078e333501b747d5435_icgraph}
\end{center}
\end{figure}
\Hypertarget{crypt-utils_8c_a94b5b388b3f00982ccee72b192077e76}\label{crypt-utils_8c_a94b5b388b3f00982ccee72b192077e76} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!do\_crypt@{do\_crypt}}
\index{do\_crypt@{do\_crypt}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{do\_crypt()}{do\_crypt()}}
{\footnotesize\ttfamily int do\+\_\+crypt (\begin{DoxyParamCaption}\item[{FILE \texorpdfstring{$\ast$}{*}}]{in,  }\item[{FILE \texorpdfstring{$\ast$}{*}}]{out,  }\item[{int}]{action,  }\item[{unsigned char \texorpdfstring{$\ast$}{*}}]{key\+\_\+str }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [extern]}}



High level function interface for performing AES encryption on FILE pointers Uses Open\+SSL libcrypto EVP API ~\newline
. 

\begin{DoxyAuthor}{Author}
By Andy Sayler (www.\+andysayler.\+com) ~\newline
 Created 04/17/12 ~\newline
 

Modified 18/10/23 by \mbox{[}Carlo Alberto Giordano\mbox{]} ~\newline

\end{DoxyAuthor}
Derived from Open\+SSL.\+org EVP\+\_\+\+Encrypt\+\_\+\texorpdfstring{$\ast$}{*} Manpage Examples ~\newline
 \href{http://www.openssl.org/docs/crypto/EVP_EncryptInit.html\#EXAMPLES}{\texttt{ http\+://www.\+openssl.\+org/docs/crypto/\+EVP\+\_\+\+Encrypt\+Init.\+html\#\+EXAMPLES}} ~\newline
 With additional information from Saju Pillai\textquotesingle{}s Open\+SSL AES Example ~\newline
 \href{http://saju.net.in/blog/?p=36}{\texttt{ http\+://saju.\+net.\+in/blog/?p=36}} ~\newline
 \href{http://saju.net.in/code/misc/openssl_aes.c.txt}{\texttt{ http\+://saju.\+net.\+in/code/misc/openssl\+\_\+aes.\+c.\+txt}} ~\newline

\begin{DoxyParams}{Parameters}
{\em in} & The input file \\
\hline
{\em out} & The output file \\
\hline
{\em action} & Defines if the action to do on the input file should be of encryption or decryption. \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\doxylink{crypt-utils_8h_a1cb0c60ca582db30ae87362ca43e8c19}{ENCRYPT} 

\doxylink{crypt-utils_8h_a36fab47015485191712a579a059a7c20}{DECRYPT} 
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
{\em key\+\_\+str} & The key that must be AES 256 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if successful, 0 otherwise. An error might be printen by print\+\_\+err() function, 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
print\+\_\+err 
\end{DoxySeeAlso}
\begin{DoxyNote}{Note}
This function cyphers using AES 256 CBC 
\end{DoxyNote}


Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00063}{63}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.



References \mbox{\hyperlink{crypt-utils_8c_source_l00021}{BLOCKSIZE}}, \mbox{\hyperlink{crypt-utils_8c_source_l00028}{IV\+\_\+\+SIZE}}, and \mbox{\hyperlink{crypt-utils_8c_source_l00034}{KEY\+\_\+\+SIZE}}.



Referenced by \mbox{\hyperlink{tcfs_8c_source_l00734}{tcfs\+\_\+read()}}, and \mbox{\hyperlink{tcfs_8c_source_l00830}{tcfs\+\_\+write()}}.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=228pt]{crypt-utils_8c_a94b5b388b3f00982ccee72b192077e76_icgraph}
\end{center}
\end{figure}
\Hypertarget{crypt-utils_8c_aa4a7facde8c6f63a7225c07e92232b2e}\label{crypt-utils_8c_aa4a7facde8c6f63a7225c07e92232b2e} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!encrypt\_file\_name\_with\_hex@{encrypt\_file\_name\_with\_hex}}
\index{encrypt\_file\_name\_with\_hex@{encrypt\_file\_name\_with\_hex}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{encrypt\_file\_name\_with\_hex()}{encrypt\_file\_name\_with\_hex()}}
{\footnotesize\ttfamily const char \texorpdfstring{$\ast$}{*} encrypt\+\_\+file\+\_\+name\+\_\+with\+\_\+hex (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{file,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{key }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00398}{398}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.



References \mbox{\hyperlink{crypt-utils_8c_source_l00278}{encrypt\+\_\+string()}}, and \mbox{\hyperlink{tcfs__utils_8c_source_l00182}{string\+\_\+to\+\_\+hex()}}.



Referenced by \mbox{\hyperlink{crypt-utils_8c_source_l00420}{encrypt\+\_\+path()}}, and \mbox{\hyperlink{crypt-utils_8c_source_l00532}{encrypt\+\_\+path\+\_\+and\+\_\+filename()}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{crypt-utils_8c_aa4a7facde8c6f63a7225c07e92232b2e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{crypt-utils_8c_aa4a7facde8c6f63a7225c07e92232b2e_icgraph}
\end{center}
\end{figure}
\Hypertarget{crypt-utils_8c_ad9b10366ade9f2129ec2613fdc76df80}\label{crypt-utils_8c_ad9b10366ade9f2129ec2613fdc76df80} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!encrypt\_path@{encrypt\_path}}
\index{encrypt\_path@{encrypt\_path}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{encrypt\_path()}{encrypt\_path()}}
{\footnotesize\ttfamily const char \texorpdfstring{$\ast$}{*} encrypt\+\_\+path (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{path,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{key }\end{DoxyParamCaption})}



Encrypts each part of the given path using a specified key. 


\begin{DoxyParams}{Parameters}
{\em path} & The input path to be encrypted. \\
\hline
{\em key} & The encryption key. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A dynamically allocated string containing the encrypted path. It is the responsibility of the caller to free this memory. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00420}{420}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.



References \mbox{\hyperlink{crypt-utils_8c_source_l00398}{encrypt\+\_\+file\+\_\+name\+\_\+with\+\_\+hex()}}, and \mbox{\hyperlink{tcfs__utils_8c_source_l00262}{log\+Message()}}.



Referenced by \mbox{\hyperlink{tcfs_8c_source_l00132}{tcfs\+\_\+access()}}, \mbox{\hyperlink{tcfs_8c_source_l00497}{tcfs\+\_\+chmod()}}, \mbox{\hyperlink{tcfs_8c_source_l00530}{tcfs\+\_\+chown()}}, \mbox{\hyperlink{tcfs_8c_source_l00099}{tcfs\+\_\+getattr()}}, \mbox{\hyperlink{tcfs_8c_source_l00324}{tcfs\+\_\+mkdir()}}, \mbox{\hyperlink{tcfs_8c_source_l00286}{tcfs\+\_\+mknod()}}, \mbox{\hyperlink{tcfs_8c_source_l00651}{tcfs\+\_\+open()}}, \mbox{\hyperlink{tcfs_8c_source_l00067}{tcfs\+\_\+opendir()}}, \mbox{\hyperlink{tcfs_8c_source_l00734}{tcfs\+\_\+read()}}, \mbox{\hyperlink{tcfs_8c_source_l00196}{tcfs\+\_\+readdir()}}, \mbox{\hyperlink{tcfs_8c_source_l00162}{tcfs\+\_\+readlink()}}, \mbox{\hyperlink{tcfs_8c_source_l00377}{tcfs\+\_\+rmdir()}}, \mbox{\hyperlink{tcfs_8c_source_l00979}{tcfs\+\_\+setxattr()}}, \mbox{\hyperlink{tcfs_8c_source_l00559}{tcfs\+\_\+truncate()}}, \mbox{\hyperlink{tcfs_8c_source_l00351}{tcfs\+\_\+unlink()}}, \mbox{\hyperlink{tcfs_8c_source_l00612}{tcfs\+\_\+utimens()}}, and \mbox{\hyperlink{tcfs_8c_source_l00830}{tcfs\+\_\+write()}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{crypt-utils_8c_ad9b10366ade9f2129ec2613fdc76df80_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{crypt-utils_8c_ad9b10366ade9f2129ec2613fdc76df80_icgraph}
\end{center}
\end{figure}
\Hypertarget{crypt-utils_8c_a5c45db4d3db3ef274fb6356e1a95e644}\label{crypt-utils_8c_a5c45db4d3db3ef274fb6356e1a95e644} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!encrypt\_path\_and\_filename@{encrypt\_path\_and\_filename}}
\index{encrypt\_path\_and\_filename@{encrypt\_path\_and\_filename}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{encrypt\_path\_and\_filename()}{encrypt\_path\_and\_filename()}}
{\footnotesize\ttfamily const char \texorpdfstring{$\ast$}{*} encrypt\+\_\+path\+\_\+and\+\_\+filename (\begin{DoxyParamCaption}\item[{const char \texorpdfstring{$\ast$}{*}}]{path,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{key }\end{DoxyParamCaption})}



Encrypts the given filename with its path using a specified key. 


\begin{DoxyParams}{Parameters}
{\em path} & The input path to be encrypted. \\
\hline
{\em key} & The encryption key. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A dynamically allocated string containing the encrypted path with the encrypted filename. It is the responsibility of the caller to free this memory. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00532}{532}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.



References \mbox{\hyperlink{crypt-utils_8c_source_l00398}{encrypt\+\_\+file\+\_\+name\+\_\+with\+\_\+hex()}}, and \mbox{\hyperlink{tcfs__utils_8c_source_l00262}{log\+Message()}}.



Referenced by \mbox{\hyperlink{tcfs_8c_source_l01031}{tcfs\+\_\+create()}}, \mbox{\hyperlink{tcfs_8c_source_l01140}{tcfs\+\_\+fsync()}}, \mbox{\hyperlink{tcfs_8c_source_l01199}{tcfs\+\_\+getxattr()}}, \mbox{\hyperlink{tcfs_8c_source_l00465}{tcfs\+\_\+link()}}, \mbox{\hyperlink{tcfs_8c_source_l01229}{tcfs\+\_\+listxattr()}}, \mbox{\hyperlink{tcfs_8c_source_l01111}{tcfs\+\_\+release()}}, \mbox{\hyperlink{tcfs_8c_source_l01273}{tcfs\+\_\+removexattr()}}, \mbox{\hyperlink{tcfs_8c_source_l00436}{tcfs\+\_\+rename()}}, and \mbox{\hyperlink{tcfs_8c_source_l00404}{tcfs\+\_\+symlink()}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{crypt-utils_8c_a5c45db4d3db3ef274fb6356e1a95e644_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{crypt-utils_8c_a5c45db4d3db3ef274fb6356e1a95e644_icgraph}
\end{center}
\end{figure}
\Hypertarget{crypt-utils_8c_aa926098a8843cf0ab6bd7eb8b3bbd2e6}\label{crypt-utils_8c_aa926098a8843cf0ab6bd7eb8b3bbd2e6} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!encrypt\_string@{encrypt\_string}}
\index{encrypt\_string@{encrypt\_string}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{encrypt\_string()}{encrypt\_string()}}
{\footnotesize\ttfamily unsigned char \texorpdfstring{$\ast$}{*} encrypt\+\_\+string (\begin{DoxyParamCaption}\item[{unsigned char \texorpdfstring{$\ast$}{*}}]{plaintext,  }\item[{const char \texorpdfstring{$\ast$}{*}}]{key,  }\item[{int \texorpdfstring{$\ast$}{*}}]{encrypted\+\_\+key\+\_\+len }\end{DoxyParamCaption})}



Encrypt the \texorpdfstring{$\ast$}{*}plaintext string using a AES 256 key. 


\begin{DoxyParams}{Parameters}
{\em plaintext} & This is the string to encrypt \\
\hline
{\em key} & The AES 256 KEY \\
\hline
{\em encrypted\+\_\+len} & This will be set to the encrypted string length \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
unsigned char \texorpdfstring{$\ast$}{*} The encrypted string will be allocated and then returned 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
After the use remember to free the result 
\end{DoxyNote}


Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00278}{278}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.



Referenced by \mbox{\hyperlink{crypt-utils_8c_source_l00398}{encrypt\+\_\+file\+\_\+name\+\_\+with\+\_\+hex()}}, and \mbox{\hyperlink{tcfs_8c_source_l01031}{tcfs\+\_\+create()}}.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{crypt-utils_8c_aa926098a8843cf0ab6bd7eb8b3bbd2e6_icgraph}
\end{center}
\end{figure}
\Hypertarget{crypt-utils_8c_a8845f5705eaafda836aac91d5881876f}\label{crypt-utils_8c_a8845f5705eaafda836aac91d5881876f} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!generate\_key@{generate\_key}}
\index{generate\_key@{generate\_key}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{generate\_key()}{generate\_key()}}
{\footnotesize\ttfamily void generate\+\_\+key (\begin{DoxyParamCaption}\item[{unsigned char \texorpdfstring{$\ast$}{*}}]{destination }\end{DoxyParamCaption})}



Generate a new AES 256 key for a file. 


\begin{DoxyParams}{Parameters}
{\em destination} & Pointer to the string in which the generated key will be saved. If an error occurs it will be set to NULL \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00235}{235}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.



References \mbox{\hyperlink{crypt-utils_8c_source_l00202}{add\+\_\+entropy()}}, \mbox{\hyperlink{crypt-utils_8c_source_l00174}{check\+\_\+entropy()}}, \mbox{\hyperlink{crypt-utils_8c_source_l00388}{is\+\_\+valid\+\_\+key()}}, \mbox{\hyperlink{tcfs__utils_8c_source_l00262}{log\+Message()}}, and \mbox{\hyperlink{tcfs__utils_8c_source_l00165}{print\+\_\+aes\+\_\+key()}}.



Referenced by \mbox{\hyperlink{tcfs_8c_source_l01031}{tcfs\+\_\+create()}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{crypt-utils_8c_a8845f5705eaafda836aac91d5881876f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=255pt]{crypt-utils_8c_a8845f5705eaafda836aac91d5881876f_icgraph}
\end{center}
\end{figure}
\Hypertarget{crypt-utils_8c_a36c2342a7c47b8f41bf628bf473b1c97}\label{crypt-utils_8c_a36c2342a7c47b8f41bf628bf473b1c97} 
\index{crypt-\/utils.c@{crypt-\/utils.c}!is\_valid\_key@{is\_valid\_key}}
\index{is\_valid\_key@{is\_valid\_key}!crypt-\/utils.c@{crypt-\/utils.c}}
\doxysubsubsection{\texorpdfstring{is\_valid\_key()}{is\_valid\_key()}}
{\footnotesize\ttfamily int is\+\_\+valid\+\_\+key (\begin{DoxyParamCaption}\item[{const unsigned char \texorpdfstring{$\ast$}{*}}]{key }\end{DoxyParamCaption})}



Check if a given key is valid. 


\begin{DoxyParams}{Parameters}
{\em key} & The key to validate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if successful, 0 otherwise. An error might be printen by print\+\_\+err() function, 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
print\+\_\+err 
\end{DoxySeeAlso}
\begin{DoxyNote}{Note}
This function only checks for key length 
\end{DoxyNote}


Definition at line \mbox{\hyperlink{crypt-utils_8c_source_l00388}{388}} of file \mbox{\hyperlink{crypt-utils_8c_source}{crypt-\/utils.\+c}}.



Referenced by \mbox{\hyperlink{crypt-utils_8c_source_l00235}{generate\+\_\+key()}}, \mbox{\hyperlink{tcfs_8c_source_l01412}{main()}}, and \mbox{\hyperlink{tcfs_8c_source_l01031}{tcfs\+\_\+create()}}.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{crypt-utils_8c_a36c2342a7c47b8f41bf628bf473b1c97_icgraph}
\end{center}
\end{figure}
