<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_crypt-utils_8h" xml:lang="en-US">
<title>userspace-module/utils/crypt-utils/crypt-utils.h File Reference</title>
<indexterm><primary>userspace-module/utils/crypt-utils/crypt-utils.h</primary></indexterm>
<para>

<para>Header file for <link linkend="_crypt-utils_8c">crypt-utils.c</link>, which provides functions for encryption and decryption using AES-256, as well as other utility functions. </para>
 
</para>
<programlisting linenumbering="unnumbered">#include &lt;ctype.h&gt;<?linebreak?>#include &lt;libgen.h&gt;<?linebreak?>#include &lt;stdio.h&gt;<?linebreak?>#include &lt;stdlib.h&gt;<?linebreak?>#include &lt;string.h&gt;<?linebreak?>#include &lt;sys/mman.h&gt;<?linebreak?>#include &lt;unistd.h&gt;<?linebreak?>#include &lt;openssl/aes.h&gt;<?linebreak?>#include &lt;openssl/bio.h&gt;<?linebreak?>#include &lt;openssl/buffer.h&gt;<?linebreak?>#include &lt;openssl/evp.h&gt;<?linebreak?>#include &lt;openssl/rand.h&gt;<?linebreak?>#include &quot;../tcfs_utils/tcfs_utils.h&quot;<?linebreak?></programlisting>Include dependency graph for crypt-utils.h:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h__incl.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
This graph shows which files directly or indirectly include this file:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h__dep__incl.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
<simplesect>
    <title>Macros    </title>
        <itemizedlist>
            <listitem><para>#define <link linkend="_crypt-utils_8h_1a1cb0c60ca582db30ae87362ca43e8c19">ENCRYPT</link>&#160;&#160;&#160;true</para>

<para>Signifies that the selected action is encryption. </para>
</listitem>
            <listitem><para>#define <link linkend="_crypt-utils_8h_1a36fab47015485191712a579a059a7c20">DECRYPT</link>&#160;&#160;&#160;false</para>

<para>Signifies that the selected action is decryption. </para>
</listitem>
        </itemizedlist>
</simplesect>
<simplesect>
    <title>Functions    </title>
        <itemizedlist>
            <listitem><para>int <link linkend="_crypt-utils_8h_1a94b5b388b3f00982ccee72b192077e76">do_crypt</link> (FILE *in, FILE *out, int action, unsigned char *key_str)</para>

<para>High level function interface for performing AES encryption on FILE pointers Uses OpenSSL libcrypto EVP API <?linebreak?>. </para>
</listitem>
            <listitem><para>void <link linkend="_crypt-utils_8h_1a8845f5705eaafda836aac91d5881876f">generate_key</link> (unsigned char *destination)</para>

<para>Generate a new AES 256 key for a file. </para>
</listitem>
            <listitem><para>unsigned char * <link linkend="_crypt-utils_8h_1a8bf9483dae26e9c0a1c45d77b8f1dce8">encrypt_string</link> (unsigned char *plaintext, const char *key, int *encrypted_len)</para>

<para>Encrypt the *plaintext string using a AES 256 key. </para>
</listitem>
            <listitem><para>unsigned char * <link linkend="_crypt-utils_8h_1a02ee5ac64d2d2d441edcca915e480503">decrypt_string</link> (unsigned char *base64_ciphertext, const char *key)</para>

<para>Decrypt the *ciphertext string using a AES 256 key. </para>
</listitem>
            <listitem><para>int <link linkend="_crypt-utils_8h_1a36c2342a7c47b8f41bf628bf473b1c97">is_valid_key</link> (const unsigned char *key)</para>

<para>Check if a given key is valid. </para>
</listitem>
            <listitem><para>const char * <link linkend="_crypt-utils_8h_1aa4a7facde8c6f63a7225c07e92232b2e">encrypt_file_name_with_hex</link> (const char *file, const char *key)</para>
</listitem>
            <listitem><para>const char * <link linkend="_crypt-utils_8h_1a3b003481e5c188ac1d6f63e09e6f3a34">decrypt_file_name_with_hex</link> (const char *enc_file, const char *key)</para>
</listitem>
            <listitem><para>const char * <link linkend="_crypt-utils_8h_1ad9b10366ade9f2129ec2613fdc76df80">encrypt_path</link> (const char *path, const char *key)</para>

<para>Encrypts each part of the given path using a specified key. </para>
</listitem>
            <listitem><para>const char * <link linkend="_crypt-utils_8h_1a5c45db4d3db3ef274fb6356e1a95e644">encrypt_path_and_filename</link> (const char *path, const char *key)</para>

<para>Encrypts the given filename with its path using a specified key. </para>
</listitem>
            <listitem><para>const char * <link linkend="_crypt-utils_8h_1a1899c23a523d11ed1cb5601eabdb023d">decrypt_path</link> (const char *encrypted_path, const char *key)</para>

<para>Decrypts each part of the given encrypted path using a specified key. </para>
</listitem>
            <listitem><para>const char * <link linkend="_crypt-utils_8h_1a373f8aedbcd8b6ce22fe7bdfeb2961c2">decrypt_path_and_filename</link> (const char *encrypted_path, const char *key)</para>

<para>Decrypts the given encrypted filename with its path using a specified key. </para>
</listitem>
        </itemizedlist>
</simplesect>
<section>
<title>Detailed Description</title>

<para>Header file for <link linkend="_crypt-utils_8c">crypt-utils.c</link>, which provides functions for encryption and decryption using AES-256, as well as other utility functions. </para>
<para>
Definition in file <link linkend="_crypt-utils_8h_source">crypt-utils.h</link>.</para>
</section>
<section>
<title>Macro Definition Documentation</title>
<anchor xml:id="_crypt-utils_8h_1a36fab47015485191712a579a059a7c20"/><section>
    <title>DECRYPT</title>
<indexterm><primary>DECRYPT</primary><secondary>crypt-utils.h</secondary></indexterm>
<indexterm><primary>crypt-utils.h</primary><secondary>DECRYPT</secondary></indexterm>
<para><computeroutput>#define DECRYPT&#160;&#160;&#160;false</computeroutput></para><para>

<para>Signifies that the selected action is decryption. </para>
</para>
<para>
Definition at line <link linkend="_crypt-utils_8h_source_1l00032">32</link> of file <link linkend="_crypt-utils_8h_source">crypt-utils.h</link>.</para>
</section>
<anchor xml:id="_crypt-utils_8h_1a1cb0c60ca582db30ae87362ca43e8c19"/><section>
    <title>ENCRYPT</title>
<indexterm><primary>ENCRYPT</primary><secondary>crypt-utils.h</secondary></indexterm>
<indexterm><primary>crypt-utils.h</primary><secondary>ENCRYPT</secondary></indexterm>
<para><computeroutput>#define ENCRYPT&#160;&#160;&#160;true</computeroutput></para><para>

<para>Signifies that the selected action is encryption. </para>
</para>
<para>
Definition at line <link linkend="_crypt-utils_8h_source_1l00027">27</link> of file <link linkend="_crypt-utils_8h_source">crypt-utils.h</link>.</para>
</section>
</section>
<section>
<title>Function Documentation</title>
<anchor xml:id="_crypt-utils_8h_1a3b003481e5c188ac1d6f63e09e6f3a34"/><section>
    <title>decrypt_file_name_with_hex()</title>
<indexterm><primary>decrypt_file_name_with_hex</primary><secondary>crypt-utils.h</secondary></indexterm>
<indexterm><primary>crypt-utils.h</primary><secondary>decrypt_file_name_with_hex</secondary></indexterm>
<para><computeroutput>const char * decrypt_file_name_with_hex (const char * enc_file, const char * key)</computeroutput></para><para>
Definition at line <link linkend="_crypt-utils_8c_source_1l00406">406</link> of file <link linkend="_crypt-utils_8c_source">crypt-utils.c</link>.</para>
<para>
References <link linkend="_crypt-utils_8c_source_1l00330">decrypt_string()</link>, and <link linkend="_tcfs__utils_8c_source_1l00218">hex_to_string()</link>.</para>
<para>
Referenced by <link linkend="_crypt-utils_8c_source_1l00645">decrypt_path()</link>, <link linkend="_crypt-utils_8c_source_1l00759">decrypt_path_and_filename()</link>, and <link linkend="_tcfs_8c_source_1l00196">tcfs_readdir()</link>.</para>
Here is the call graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_a3b003481e5c188ac1d6f63e09e6f3a34_cgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
Here is the caller graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_a3b003481e5c188ac1d6f63e09e6f3a34_icgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
</section>
<anchor xml:id="_crypt-utils_8h_1a1899c23a523d11ed1cb5601eabdb023d"/><section>
    <title>decrypt_path()</title>
<indexterm><primary>decrypt_path</primary><secondary>crypt-utils.h</secondary></indexterm>
<indexterm><primary>crypt-utils.h</primary><secondary>decrypt_path</secondary></indexterm>
<para><computeroutput>const char * decrypt_path (const char * encrypted_path, const char * key)</computeroutput></para><para>

<para>Decrypts each part of the given encrypted path using a specified key. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>encrypted_path</entry><entry>
<para>The input encrypted path to be decrypted. </para>
</entry>
                            </row>
                            <row>
<entry>key</entry><entry>
<para>The decryption key. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>A dynamically allocated string containing the decrypted path. It is the responsibility of the caller to free this memory. </para>
</formalpara>
</para>
<para>
Definition at line <link linkend="_crypt-utils_8c_source_1l00645">645</link> of file <link linkend="_crypt-utils_8c_source">crypt-utils.c</link>.</para>
<para>
References <link linkend="_crypt-utils_8c_source_1l00406">decrypt_file_name_with_hex()</link>, and <link linkend="_tcfs__utils_8c_source_1l00262">logMessage()</link>.</para>
<para>
Referenced by <link linkend="_tcfs_8c_source_1l00196">tcfs_readdir()</link>.</para>
Here is the call graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_a1899c23a523d11ed1cb5601eabdb023d_cgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
Here is the caller graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_a1899c23a523d11ed1cb5601eabdb023d_icgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
</section>
<anchor xml:id="_crypt-utils_8h_1a373f8aedbcd8b6ce22fe7bdfeb2961c2"/><section>
    <title>decrypt_path_and_filename()</title>
<indexterm><primary>decrypt_path_and_filename</primary><secondary>crypt-utils.h</secondary></indexterm>
<indexterm><primary>crypt-utils.h</primary><secondary>decrypt_path_and_filename</secondary></indexterm>
<para><computeroutput>const char * decrypt_path_and_filename (const char * encrypted_path, const char * key)</computeroutput></para><para>

<para>Decrypts the given encrypted filename with its path using a specified key. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>encrypted_path</entry><entry>
<para>The input encrypted path to be decrypted. </para>
</entry>
                            </row>
                            <row>
<entry>key</entry><entry>
<para>The decryption key. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>A dynamically allocated string containing the decrypted path with the decrypted filename. It is the responsibility of the caller to free this memory. </para>
</formalpara>
</para>
<para>
Definition at line <link linkend="_crypt-utils_8c_source_1l00759">759</link> of file <link linkend="_crypt-utils_8c_source">crypt-utils.c</link>.</para>
<para>
References <link linkend="_crypt-utils_8c_source_1l00406">decrypt_file_name_with_hex()</link>, and <link linkend="_tcfs__utils_8c_source_1l00262">logMessage()</link>.</para>
Here is the call graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_a373f8aedbcd8b6ce22fe7bdfeb2961c2_cgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
</section>
<anchor xml:id="_crypt-utils_8h_1a02ee5ac64d2d2d441edcca915e480503"/><section>
    <title>decrypt_string()</title>
<indexterm><primary>decrypt_string</primary><secondary>crypt-utils.h</secondary></indexterm>
<indexterm><primary>crypt-utils.h</primary><secondary>decrypt_string</secondary></indexterm>
<para><computeroutput>unsigned char * decrypt_string (unsigned char * ciphertext, const char * key)</computeroutput></para><para>

<para>Decrypt the *ciphertext string using a AES 256 key. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>ciphertext</entry><entry>
<para>This is the string to decrypt in HEX format </para>
</entry>
                            </row>
                            <row>
<entry>key</entry><entry>
<para>The AES 256 KEY </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>unsigned char * The plaintext string will be allocated and then returned </para>
</formalpara>
<note><title>Note</title>

<para>After the use remember to free the result </para>
</note>
</para>
<para>
Definition at line <link linkend="_crypt-utils_8c_source_1l00330">330</link> of file <link linkend="_crypt-utils_8c_source">crypt-utils.c</link>.</para>
<para>
References <link linkend="_tcfs__utils_8c_source_1l00262">logMessage()</link>.</para>
<para>
Referenced by <link linkend="_crypt-utils_8c_source_1l00406">decrypt_file_name_with_hex()</link>, <link linkend="_tcfs_8c_source_1l00734">tcfs_read()</link>, and <link linkend="_tcfs_8c_source_1l00830">tcfs_write()</link>.</para>
Here is the call graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_a02ee5ac64d2d2d441edcca915e480503_cgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
Here is the caller graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_a02ee5ac64d2d2d441edcca915e480503_icgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
</section>
<anchor xml:id="_crypt-utils_8h_1a94b5b388b3f00982ccee72b192077e76"/><section>
    <title>do_crypt()</title>
<indexterm><primary>do_crypt</primary><secondary>crypt-utils.h</secondary></indexterm>
<indexterm><primary>crypt-utils.h</primary><secondary>do_crypt</secondary></indexterm>
<para><computeroutput>int do_crypt (FILE * in, FILE * out, int action, unsigned char * key_str)<computeroutput>[extern]</computeroutput></computeroutput></para><para>

<para>High level function interface for performing AES encryption on FILE pointers Uses OpenSSL libcrypto EVP API <?linebreak?>. </para>
</para>

<para><formalpara><title>Author</title>

<para>By Andy Sayler (www.andysayler.com) <?linebreak?> Created 04/17/12 <?linebreak?> </para>

<para>Modified 18/10/23 by [Carlo Alberto Giordano] <?linebreak?></para>
</formalpara>
Derived from OpenSSL.org EVP_Encrypt_* Manpage Examples <?linebreak?> <link xlink:href="http://www.openssl.org/docs/crypto/EVP_EncryptInit.html#EXAMPLES">http://www.openssl.org/docs/crypto/EVP_EncryptInit.html#EXAMPLES</link> <?linebreak?> With additional information from Saju Pillai&apos;s OpenSSL AES Example <?linebreak?> <link xlink:href="http://saju.net.in/blog/?p=36">http://saju.net.in/blog/?p=36</link> <?linebreak?> <link xlink:href="http://saju.net.in/code/misc/openssl_aes.c.txt">http://saju.net.in/code/misc/openssl_aes.c.txt</link> <?linebreak?>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>in</entry><entry>
<para>The input file </para>
</entry>
                            </row>
                            <row>
<entry>out</entry><entry>
<para>The output file </para>
</entry>
                            </row>
                            <row>
<entry>action</entry><entry>
<para>Defines if the action to do on the input file should be of encryption or decryption. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>See also</title>

<para><link linkend="_crypt-utils_8h_1a1cb0c60ca582db30ae87362ca43e8c19">ENCRYPT</link> </para>

<para><link linkend="_crypt-utils_8h_1a36fab47015485191712a579a059a7c20">DECRYPT</link> </para>
</formalpara>

                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>key_str</entry><entry>
<para>The key that must be AES 256 </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>1 if successful, 0 otherwise. An error might be printen by print_err() function, </para>
</formalpara>
<formalpara><title>See also</title>

<para>print_err </para>
</formalpara>
<note><title>Note</title>

<para>This function cyphers using AES 256 CBC </para>
</note>
</para>
<para>
Definition at line <link linkend="_crypt-utils_8c_source_1l00063">63</link> of file <link linkend="_crypt-utils_8c_source">crypt-utils.c</link>.</para>
<para>
References <link linkend="_crypt-utils_8c_source_1l00021">BLOCKSIZE</link>, <link linkend="_crypt-utils_8c_source_1l00028">IV_SIZE</link>, and <link linkend="_crypt-utils_8c_source_1l00034">KEY_SIZE</link>.</para>
<para>
Referenced by <link linkend="_tcfs_8c_source_1l00734">tcfs_read()</link>, and <link linkend="_tcfs_8c_source_1l00830">tcfs_write()</link>.</para>
Here is the caller graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_a94b5b388b3f00982ccee72b192077e76_icgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
</section>
<anchor xml:id="_crypt-utils_8h_1aa4a7facde8c6f63a7225c07e92232b2e"/><section>
    <title>encrypt_file_name_with_hex()</title>
<indexterm><primary>encrypt_file_name_with_hex</primary><secondary>crypt-utils.h</secondary></indexterm>
<indexterm><primary>crypt-utils.h</primary><secondary>encrypt_file_name_with_hex</secondary></indexterm>
<para><computeroutput>const char * encrypt_file_name_with_hex (const char * file, const char * key)</computeroutput></para><para>
Definition at line <link linkend="_crypt-utils_8c_source_1l00398">398</link> of file <link linkend="_crypt-utils_8c_source">crypt-utils.c</link>.</para>
<para>
References <link linkend="_crypt-utils_8c_source_1l00278">encrypt_string()</link>, and <link linkend="_tcfs__utils_8c_source_1l00182">string_to_hex()</link>.</para>
<para>
Referenced by <link linkend="_crypt-utils_8c_source_1l00420">encrypt_path()</link>, and <link linkend="_crypt-utils_8c_source_1l00532">encrypt_path_and_filename()</link>.</para>
Here is the call graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_aa4a7facde8c6f63a7225c07e92232b2e_cgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
Here is the caller graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_aa4a7facde8c6f63a7225c07e92232b2e_icgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
</section>
<anchor xml:id="_crypt-utils_8h_1ad9b10366ade9f2129ec2613fdc76df80"/><section>
    <title>encrypt_path()</title>
<indexterm><primary>encrypt_path</primary><secondary>crypt-utils.h</secondary></indexterm>
<indexterm><primary>crypt-utils.h</primary><secondary>encrypt_path</secondary></indexterm>
<para><computeroutput>const char * encrypt_path (const char * path, const char * key)</computeroutput></para><para>

<para>Encrypts each part of the given path using a specified key. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>path</entry><entry>
<para>The input path to be encrypted. </para>
</entry>
                            </row>
                            <row>
<entry>key</entry><entry>
<para>The encryption key. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>A dynamically allocated string containing the encrypted path. It is the responsibility of the caller to free this memory. </para>
</formalpara>
</para>
<para>
Definition at line <link linkend="_crypt-utils_8c_source_1l00420">420</link> of file <link linkend="_crypt-utils_8c_source">crypt-utils.c</link>.</para>
<para>
References <link linkend="_crypt-utils_8c_source_1l00398">encrypt_file_name_with_hex()</link>, and <link linkend="_tcfs__utils_8c_source_1l00262">logMessage()</link>.</para>
<para>
Referenced by <link linkend="_tcfs_8c_source_1l00132">tcfs_access()</link>, <link linkend="_tcfs_8c_source_1l00497">tcfs_chmod()</link>, <link linkend="_tcfs_8c_source_1l00530">tcfs_chown()</link>, <link linkend="_tcfs_8c_source_1l00099">tcfs_getattr()</link>, <link linkend="_tcfs_8c_source_1l00324">tcfs_mkdir()</link>, <link linkend="_tcfs_8c_source_1l00286">tcfs_mknod()</link>, <link linkend="_tcfs_8c_source_1l00651">tcfs_open()</link>, <link linkend="_tcfs_8c_source_1l00067">tcfs_opendir()</link>, <link linkend="_tcfs_8c_source_1l00734">tcfs_read()</link>, <link linkend="_tcfs_8c_source_1l00196">tcfs_readdir()</link>, <link linkend="_tcfs_8c_source_1l00162">tcfs_readlink()</link>, <link linkend="_tcfs_8c_source_1l00377">tcfs_rmdir()</link>, <link linkend="_tcfs_8c_source_1l00979">tcfs_setxattr()</link>, <link linkend="_tcfs_8c_source_1l00559">tcfs_truncate()</link>, <link linkend="_tcfs_8c_source_1l00351">tcfs_unlink()</link>, <link linkend="_tcfs_8c_source_1l00612">tcfs_utimens()</link>, and <link linkend="_tcfs_8c_source_1l00830">tcfs_write()</link>.</para>
Here is the call graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_ad9b10366ade9f2129ec2613fdc76df80_cgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
Here is the caller graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_ad9b10366ade9f2129ec2613fdc76df80_icgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
</section>
<anchor xml:id="_crypt-utils_8h_1a5c45db4d3db3ef274fb6356e1a95e644"/><section>
    <title>encrypt_path_and_filename()</title>
<indexterm><primary>encrypt_path_and_filename</primary><secondary>crypt-utils.h</secondary></indexterm>
<indexterm><primary>crypt-utils.h</primary><secondary>encrypt_path_and_filename</secondary></indexterm>
<para><computeroutput>const char * encrypt_path_and_filename (const char * path, const char * key)</computeroutput></para><para>

<para>Encrypts the given filename with its path using a specified key. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>path</entry><entry>
<para>The input path to be encrypted. </para>
</entry>
                            </row>
                            <row>
<entry>key</entry><entry>
<para>The encryption key. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>A dynamically allocated string containing the encrypted path with the encrypted filename. It is the responsibility of the caller to free this memory. </para>
</formalpara>
</para>
<para>
Definition at line <link linkend="_crypt-utils_8c_source_1l00532">532</link> of file <link linkend="_crypt-utils_8c_source">crypt-utils.c</link>.</para>
<para>
References <link linkend="_crypt-utils_8c_source_1l00398">encrypt_file_name_with_hex()</link>, and <link linkend="_tcfs__utils_8c_source_1l00262">logMessage()</link>.</para>
<para>
Referenced by <link linkend="_tcfs_8c_source_1l01031">tcfs_create()</link>, <link linkend="_tcfs_8c_source_1l01140">tcfs_fsync()</link>, <link linkend="_tcfs_8c_source_1l01199">tcfs_getxattr()</link>, <link linkend="_tcfs_8c_source_1l00465">tcfs_link()</link>, <link linkend="_tcfs_8c_source_1l01229">tcfs_listxattr()</link>, <link linkend="_tcfs_8c_source_1l01111">tcfs_release()</link>, <link linkend="_tcfs_8c_source_1l01273">tcfs_removexattr()</link>, <link linkend="_tcfs_8c_source_1l00436">tcfs_rename()</link>, and <link linkend="_tcfs_8c_source_1l00404">tcfs_symlink()</link>.</para>
Here is the call graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_a5c45db4d3db3ef274fb6356e1a95e644_cgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
Here is the caller graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_a5c45db4d3db3ef274fb6356e1a95e644_icgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
</section>
<anchor xml:id="_crypt-utils_8h_1a8bf9483dae26e9c0a1c45d77b8f1dce8"/><section>
    <title>encrypt_string()</title>
<indexterm><primary>encrypt_string</primary><secondary>crypt-utils.h</secondary></indexterm>
<indexterm><primary>crypt-utils.h</primary><secondary>encrypt_string</secondary></indexterm>
<para><computeroutput>unsigned char * encrypt_string (unsigned char * plaintext, const char * key, int * encrypted_key_len)</computeroutput></para><para>

<para>Encrypt the *plaintext string using a AES 256 key. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>plaintext</entry><entry>
<para>This is the string to encrypt </para>
</entry>
                            </row>
                            <row>
<entry>key</entry><entry>
<para>The AES 256 KEY </para>
</entry>
                            </row>
                            <row>
<entry>encrypted_len</entry><entry>
<para>This will be set to the encrypted string length </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>unsigned char * The encrypted string will be allocated and then returned </para>
</formalpara>
<note><title>Note</title>

<para>After the use remember to free the result </para>
</note>
</para>
<para>
Definition at line <link linkend="_crypt-utils_8c_source_1l00278">278</link> of file <link linkend="_crypt-utils_8c_source">crypt-utils.c</link>.</para>
<para>
Referenced by <link linkend="_crypt-utils_8c_source_1l00398">encrypt_file_name_with_hex()</link>, and <link linkend="_tcfs_8c_source_1l01031">tcfs_create()</link>.</para>
Here is the caller graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_a8bf9483dae26e9c0a1c45d77b8f1dce8_icgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
</section>
<anchor xml:id="_crypt-utils_8h_1a8845f5705eaafda836aac91d5881876f"/><section>
    <title>generate_key()</title>
<indexterm><primary>generate_key</primary><secondary>crypt-utils.h</secondary></indexterm>
<indexterm><primary>crypt-utils.h</primary><secondary>generate_key</secondary></indexterm>
<para><computeroutput>void generate_key (unsigned char * destination)</computeroutput></para><para>

<para>Generate a new AES 256 key for a file. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>destination</entry><entry>
<para>Pointer to the string in which the generated key will be saved. If an error occurs it will be set to NULL </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>void </para>
</formalpara>
</para>
<para>
Definition at line <link linkend="_crypt-utils_8c_source_1l00235">235</link> of file <link linkend="_crypt-utils_8c_source">crypt-utils.c</link>.</para>
<para>
References <link linkend="_crypt-utils_8c_source_1l00202">add_entropy()</link>, <link linkend="_crypt-utils_8c_source_1l00174">check_entropy()</link>, <link linkend="_crypt-utils_8c_source_1l00388">is_valid_key()</link>, <link linkend="_tcfs__utils_8c_source_1l00262">logMessage()</link>, and <link linkend="_tcfs__utils_8c_source_1l00165">print_aes_key()</link>.</para>
<para>
Referenced by <link linkend="_tcfs_8c_source_1l01031">tcfs_create()</link>.</para>
Here is the call graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_a8845f5705eaafda836aac91d5881876f_cgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
Here is the caller graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_a8845f5705eaafda836aac91d5881876f_icgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
</section>
<anchor xml:id="_crypt-utils_8h_1a36c2342a7c47b8f41bf628bf473b1c97"/><section>
    <title>is_valid_key()</title>
<indexterm><primary>is_valid_key</primary><secondary>crypt-utils.h</secondary></indexterm>
<indexterm><primary>crypt-utils.h</primary><secondary>is_valid_key</secondary></indexterm>
<para><computeroutput>int is_valid_key (const unsigned char * key)</computeroutput></para><para>

<para>Check if a given key is valid. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>key</entry><entry>
<para>The key to validate </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>1 if successful, 0 otherwise. An error might be printen by print_err() function, </para>
</formalpara>
<formalpara><title>See also</title>

<para>print_err </para>
</formalpara>
<note><title>Note</title>

<para>This function only checks for key length </para>
</note>
</para>
<para>
Definition at line <link linkend="_crypt-utils_8c_source_1l00388">388</link> of file <link linkend="_crypt-utils_8c_source">crypt-utils.c</link>.</para>
<para>
Referenced by <link linkend="_crypt-utils_8c_source_1l00235">generate_key()</link>, <link linkend="_tcfs_8c_source_1l01412">main()</link>, and <link linkend="_tcfs_8c_source_1l01031">tcfs_create()</link>.</para>
Here is the caller graph for this function:<para>
    <informalfigure>
        <mediaobject>
            <imageobject>
                <imagedata width="50%" align="center" valign="middle" scalefit="0" fileref="crypt-utils_8h_a36c2342a7c47b8f41bf628bf473b1c97_icgraph.svg"></imagedata>
            </imageobject>
        </mediaobject>
    </informalfigure>
</para>
</section>
</section>
</section>
